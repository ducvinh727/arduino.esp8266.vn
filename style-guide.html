

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Espressif IoT Development Framework Style Guide &mdash; Tài liệu Lập trình IoT với ESP8266 Arduino 1.0</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Tìm Kiếm" href="search.html"/>
    <link rel="top" title="Tài liệu Lập trình IoT với ESP8266 Arduino 1.0" href="index.html"/>
        <link rel="next" title="Documenting Code" href="documenting-code.html"/>
        <link rel="prev" title="OLED" href="basic/oled.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Lập trình IoT với ESP8266 Arduino
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Cài đặt</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Cài đặt Arduino IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="board.html">Board IoT WiFi Uno</a></li>
</ul>
<p class="caption"><span class="caption-text">Cơ bản</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic/led.html">Bật tắt LED</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic/button.html">Nút nhấn</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic/oled.html">OLED</a></li>
</ul>
<p class="caption"><span class="caption-text">Tài liệu ESP8266</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://espressif.com/sites/default/files/documentation/esp32_technical_reference_manual_en.pdf">Technical Reference Manual (PDF)</a></li>
<li class="toctree-l1"><a class="reference external" href="http://espressif.com/sites/default/files/documentation/esp32_chip_pin_list_en.pdf">Pin List and Functions (PDF)</a></li>
<li class="toctree-l1"><a class="reference external" href="http://espressif.com/sites/default/files/documentation/esp32_pinout_v1_0.pdf">Chip Pinout (PDF)</a></li>
<li class="toctree-l1"><a class="reference external" href="http://espressif.com/sites/default/files/documentation/eco_and_workarounds_for_bugs_in_esp32_en.pdf">Silicon Errata (PDF)</a></li>
</ul>
<p class="caption"><span class="caption-text">Đóng góp</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Style Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#about-this-guide">About this guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c-code-formatting">C code formatting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#indentation">Indentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vertical-space">Vertical space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#horizontal-space">Horizontal space</a></li>
<li class="toctree-l3"><a class="reference internal" href="#braces">Braces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comments">Comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#formatting-your-code">Formatting your code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#documenting-code">Documenting code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#structure-and-naming">Structure and naming</a></li>
<li class="toctree-l2"><a class="reference internal" href="#language-features">Language features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="documenting-code.html">Documenting Code</a></li>
</ul>
<p class="caption"><span class="caption-text">Legal</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="COPYRIGHT.html">Copyrights and Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Lập trình IoT với ESP8266 Arduino</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Espressif IoT Development Framework Style Guide</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/style-guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="espressif-iot-development-framework-style-guide">
<h1>Espressif IoT Development Framework Style Guide<a class="headerlink" href="#espressif-iot-development-framework-style-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="about-this-guide">
<h2>About this guide<a class="headerlink" href="#about-this-guide" title="Permalink to this headline">¶</a></h2>
<p>Purpose of this style guide is to encourage use of common coding practices within the ESP-IDF.</p>
<p>Style guide is a set of rules which are aimed to help create readable, maintainable, and robust code. By writing code which looks the same way across the code base we help others read and comprehend the code. By using same conventions for spaces and newlines we reduce chances that future changes will produce huge unreadable diffs. By following common patterns for module structure and by using language features consistently we help others understand code behavior.</p>
<p>We try to keep rules simple enough, which means that they can not cover all potential cases. In some cases one has to bend these simple rules to achieve readability, maintainability, or robustness.</p>
<p>When doing modifications to third-party code used in ESP-IDF, follow the way that particular project is written. That will help propose useful changes for merging into upstream project.</p>
</div>
<div class="section" id="c-code-formatting">
<h2>C code formatting<a class="headerlink" href="#c-code-formatting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="indentation">
<h3>Indentation<a class="headerlink" href="#indentation" title="Permalink to this headline">¶</a></h3>
<p>Use 4 spaces for each indentation level. Don&#8217;t use tabs for indentation. Configure the editor to emit 4 spaces each time you press tab key.</p>
</div>
<div class="section" id="vertical-space">
<h3>Vertical space<a class="headerlink" href="#vertical-space" title="Permalink to this headline">¶</a></h3>
<p>Place one empty line between functions. Don&#8217;t begin or end a function with an empty line.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">function1</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">do_one_thing</span><span class="p">();</span>
    <span class="n">do_another_thing</span><span class="p">();</span>
                                <span class="o">//</span> <span class="n">INCORRECT</span><span class="p">,</span> <span class="n">don</span><span class="s1">&#39;t place empty line here</span>
<span class="p">}</span>
                                <span class="o">//</span> <span class="n">place</span> <span class="n">empty</span> <span class="n">line</span> <span class="n">here</span>
<span class="n">void</span> <span class="n">function2</span><span class="p">()</span>
<span class="p">{</span>
                                <span class="o">//</span> <span class="n">INCORRECT</span><span class="p">,</span> <span class="n">don</span><span class="s1">&#39;t use an empty line here</span>
    <span class="nb">int</span> <span class="n">var</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">var</span> <span class="o">&lt;</span> <span class="n">SOME_CONSTANT</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">do_stuff</span><span class="p">(</span><span class="o">&amp;</span><span class="n">var</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="horizontal-space">
<h3>Horizontal space<a class="headerlink" href="#horizontal-space" title="Permalink to this headline">¶</a></h3>
<p>Always add single space after conditional and loop keywords:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">condition</span><span class="p">)</span> <span class="p">{</span>    <span class="o">//</span> <span class="n">correct</span>
    <span class="o">//</span> <span class="o">...</span>
<span class="p">}</span>

<span class="n">switch</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>        <span class="o">//</span> <span class="n">correct</span>
    <span class="n">case</span> <span class="mi">0</span><span class="p">:</span>
        <span class="o">//</span> <span class="o">...</span>
<span class="p">}</span>

<span class="k">for</span><span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CONST</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>    <span class="o">//</span> <span class="n">INCORRECT</span>
    <span class="o">//</span> <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Add single space around binary operators. No space is necessary for unary operators. It is okay to drop space around multiply and divide operators:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="nb">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">);</span>    <span class="o">//</span> <span class="n">correct</span>

<span class="n">const</span> <span class="nb">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">);</span>        <span class="o">//</span> <span class="n">also</span> <span class="n">okay</span>

<span class="nb">int</span> <span class="n">y_cur</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="p">;</span>                                         <span class="o">//</span> <span class="n">correct</span>
<span class="o">++</span><span class="n">y_cur</span><span class="p">;</span>

<span class="n">const</span> <span class="nb">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">);</span>                <span class="o">//</span> <span class="n">INCORRECT</span>
</pre></div>
</div>
<p>No space is necessary around <code class="docutils literal"><span class="pre">.</span></code> and <code class="docutils literal"><span class="pre">-&gt;</span></code> operators.</p>
<p>Sometimes adding horizontal space within a line can help make code more readable. For example, you can add space to align function arguments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gpio_matrix_in</span><span class="p">(</span><span class="n">PIN_CAM_D6</span><span class="p">,</span>   <span class="n">I2S0I_DATA_IN14_IDX</span><span class="p">,</span> <span class="n">false</span><span class="p">);</span>
<span class="n">gpio_matrix_in</span><span class="p">(</span><span class="n">PIN_CAM_D7</span><span class="p">,</span>   <span class="n">I2S0I_DATA_IN15_IDX</span><span class="p">,</span> <span class="n">false</span><span class="p">);</span>
<span class="n">gpio_matrix_in</span><span class="p">(</span><span class="n">PIN_CAM_HREF</span><span class="p">,</span> <span class="n">I2S0I_H_ENABLE_IDX</span><span class="p">,</span>  <span class="n">false</span><span class="p">);</span>
<span class="n">gpio_matrix_in</span><span class="p">(</span><span class="n">PIN_CAM_PCLK</span><span class="p">,</span> <span class="n">I2S0I_DATA_IN15_IDX</span><span class="p">,</span> <span class="n">false</span><span class="p">);</span>
</pre></div>
</div>
<p>Note however that if someone goes to add new line with a longer identifier as first argument (e.g.  <code class="docutils literal"><span class="pre">PIN_CAM_VSYNC</span></code>), it will not fit. So other lines would have to be realigned, adding meaningless changes to the commit.</p>
<p>Therefore, use horizontal alignment sparingly, especially if you expect new lines to be added to the list later.</p>
<p>Never use TAB characters for horizontal alignment.</p>
<p>Never add trailing whitespace at the end of the line.</p>
</div>
<div class="section" id="braces">
<h3>Braces<a class="headerlink" href="#braces" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Function definition should have a brace on a separate line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">correct</span><span class="p">:</span>
<span class="n">void</span> <span class="n">function</span><span class="p">(</span><span class="nb">int</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>

<span class="o">//</span> <span class="n">NOT</span> <span class="n">like</span> <span class="n">this</span><span class="p">:</span>
<span class="n">void</span> <span class="n">function</span><span class="p">(</span><span class="nb">int</span> <span class="n">arg</span><span class="p">)</span> <span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Within a function, place opening brace on the same line with conditional and loop statements:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">do_one</span><span class="p">();</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">other_condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">do_two</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h3>
<p>Use <code class="docutils literal"><span class="pre">//</span></code> for single line comments. For multi-line comments it is okay to use either <code class="docutils literal"><span class="pre">//</span></code> on each line or a <code class="docutils literal"><span class="pre">/*</span> <span class="pre">*/</span></code> block.</p>
<p>Although not directly related to formatting, here are a few notes about using comments effectively.</p>
<ul>
<li><p class="first">Don&#8217;t use single comments to disable some functionality:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>void init_something()
{
    setup_dma();
    // load_resources();                // WHY is this thing commented, asks the reader?
    start_timer();
}
</pre></div>
</div>
</li>
<li><p class="first">If some code is no longer required, remove it completely. If you need it you can always look it up in git history of this file. If you disable some call because of temporary reasons, with an intention to restore it in the future, add explanation on the adjacent line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">init_something</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">setup_dma</span><span class="p">();</span>
    <span class="o">//</span> <span class="n">TODO</span><span class="p">:</span> <span class="n">we</span> <span class="n">should</span> <span class="n">load</span> <span class="n">resources</span> <span class="n">here</span><span class="p">,</span> <span class="n">but</span> <span class="n">loader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">fully</span> <span class="n">integrated</span> <span class="n">yet</span><span class="o">.</span>
    <span class="o">//</span> <span class="n">load_resources</span><span class="p">();</span>
    <span class="n">start_timer</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Same goes for <code class="docutils literal"><span class="pre">#if</span> <span class="pre">0</span> <span class="pre">...</span> <span class="pre">#endif</span></code> blocks. Remove code block completely if it is not used. Otherwise, add comment explaining why the block is disabled. Don&#8217;t use <code class="docutils literal"><span class="pre">#if</span> <span class="pre">0</span> <span class="pre">...</span> <span class="pre">#endif</span></code> or comments to store code snippets which you may need in the future.</p>
</li>
<li><p class="first">Don&#8217;t add trivial comments about authorship and change date. You can always look up who modified any given line using git. E.g. this comment adds clutter to the code without adding any useful information:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">init_something</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">setup_dma</span><span class="p">();</span>
    <span class="o">//</span> <span class="n">XXX</span> <span class="n">add</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">01</span>
    <span class="n">init_dma_list</span><span class="p">();</span>
    <span class="n">fill_dma_item</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="o">//</span> <span class="n">end</span> <span class="n">XXX</span> <span class="n">add</span>
    <span class="n">start_timer</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="formatting-your-code">
<h3>Formatting your code<a class="headerlink" href="#formatting-your-code" title="Permalink to this headline">¶</a></h3>
<p>You can use <code class="docutils literal"><span class="pre">astyle</span></code> program to format your code according to the above recommendations.</p>
<p>If you are writing a file from scratch, or doing a complete rewrite, feel free to re-format the entire file. If you are changing a small portion of file, don&#8217;t re-format the code you didn&#8217;t change. This will help others when they review your changes.</p>
<p>To re-format a file, run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tools</span><span class="o">/</span><span class="nb">format</span><span class="o">.</span><span class="n">sh</span> <span class="n">components</span><span class="o">/</span><span class="n">my_component</span><span class="o">/</span><span class="n">file</span><span class="o">.</span><span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="documenting-code">
<h2>Documenting code<a class="headerlink" href="#documenting-code" title="Permalink to this headline">¶</a></h2>
<p>Please see the guide here: <a class="reference internal" href="documenting-code.html"><span class="doc">Documenting Code</span></a>.</p>
</div>
<div class="section" id="structure-and-naming">
<h2>Structure and naming<a class="headerlink" href="#structure-and-naming" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="language-features">
<h2>Language features<a class="headerlink" href="#language-features" title="Permalink to this headline">¶</a></h2>
<p>To be written.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="documenting-code.html" class="btn btn-neutral float-right" title="Documenting Code" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basic/oled.html" class="btn btn-neutral" title="OLED" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, TuanPM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>