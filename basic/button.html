

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-60470603-9']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Nút nhấn &mdash; Tài liệu Lập trình IoT với ESP8266 Arduino 1.0</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Tìm Kiếm" href="../search.html"/>
    <link rel="top" title="Tài liệu Lập trình IoT với ESP8266 Arduino 1.0" href="../index.html"/>
        <link rel="next" title="Đọc Analog" href="analog.html"/>
        <link rel="prev" title="LED" href="led.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Lập trình IoT với ESP8266 Arduino
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Cài đặt</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Cài đặt Arduino IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../board.html">Board IoT WiFi Uno</a></li>
<li class="toctree-l1"><a class="reference internal" href="../connection.html">Kết nối máy tính</a></li>
<li class="toctree-l1"><a class="reference internal" href="../library.html">Cài đặt thư viện</a></li>
</ul>
<p class="caption"><span class="caption-text">Cơ bản</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="led.html">Bật tắt LED</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Nút nhấn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#demo">Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#chuan-bi">Chuẩn bị</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dau-noi">Đấu nối</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code">Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#digital-io">Digital IO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="analog.html">Analog</a></li>
<li class="toctree-l1"><a class="reference internal" href="timming.html">Thời gian &amp; Delay</a></li>
<li class="toctree-l1"><a class="reference internal" href="serial.html">Serial</a></li>
<li class="toctree-l1"><a class="reference internal" href="oled.html">OLED</a></li>
<li class="toctree-l1"><a class="reference internal" href="promem.html">Sử dụng Promem</a></li>
</ul>
<p class="caption"><span class="caption-text">WiFi</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../wifi/wifi-api.html">WiFi API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wifi/station.html">WiFi Station</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wifi/access-point.html">WiFi Access Point</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wifi/smartconfig.html">Smartconfig</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wifi/wps.html">WPS</a></li>
</ul>
<p class="caption"><span class="caption-text">Network/Protocol</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../network/http-client.html">HTTP Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/http-server.html">HTTP Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/mqtt.html">MQTT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/websocket.html">Websocket</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/mdns.html">mDNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/coap.html">CoAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/ota.html">Cập nhật firmware</a></li>
</ul>
<p class="caption"><span class="caption-text">Dự án</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects/flappy-bird.html">Game Flappy Bird</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects/heart-rate.html">Đo nhịp tim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects/onewire.html">Cảm biến nhiệt độ (onewire)</a></li>
</ul>
<p class="caption"><span class="caption-text">Tài liệu ESP8266</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://espressif.com/sites/default/files/documentation/esp8266-technical_reference_en.pdf">Technical Reference Manual (PDF)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://espressif.com/sites/default/files/documentation/0d-esp8266_pin_list_release_15-11-2014.xlsx">Pin List and Functions (XLSX)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://espressif.com/en/products/hardware/esp8266ex/resources">Tài nguyên chính thống</a></li>
</ul>
<p class="caption"><span class="caption-text">Đóng góp và bản quyền</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Hướng dẫn đóng góp</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Lập trình IoT với ESP8266 Arduino</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Nút nhấn</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/basic/button.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nut-nhan">
<h1>Nút nhấn<a class="headerlink" href="#nut-nhan" title="Permalink to this headline">¶</a></h1>
<p>Nút nhấn sẽ giúp việc ESP8266 khởi động một hành động nào đó khi cần thiết. Trong nhiều ứng dụng chúng ta hầu như đều cần những kích hoạt từ bên ngoài. Xuyên suốt cuốn sách này, sẽ dùng nút nhấn để kích hoạt chạy các ứng dụng mẫu cũng như đèn LED để thông báo các trạng thái. Trong phần này, nhấn nút đèn LED sẽ chuyển trạng thái (từ sáng -&gt; tắt và ngược lại).</p>
<p>Đây là ví dụ đơn giản, trong thực tế việc xử lý nút nhấn khá phiền phức. Bởi vì nút nhấn vật lý khi được nhấn sẽ tạo ra hàng loạt các xung lên xuống (nhiễu, bouncing...). Thường thì chỉ cần đảm bảo mức Logic của chân đo được đã được giữ ổn định trong khoảng 100 mili giây là được xem đã ổn định.</p>
<p>Ngoài cách dùng ngắt để xác định nút nhấn có được nhấn hay không - cách này sẽ tiết kiệm tài nguyên tính toán của CPU, nó chỉ được gọi khi có sự kiện sảy ra, thì còn một cách nữa là hỏi vòng: Cách này đỏi hỏi CPU liên tục kiểm tra xem mức Logic của nút nhấn. Đồng thời việc đáp ứng cũng không nhanh bằng sử dụng ngắt.</p>
<div class="admonition note">
<p class="first admonition-title">Ghi chú</p>
<p class="last">Yêu cầu:
Nhấn nút (GPIO0)thì chớp tắt đèn LED (GPIO6) và in ra cổng Serial</p>
</div>
<div class="section" id="demo">
<h2>Demo<a class="headerlink" href="#demo" title="Permalink to this headline">¶</a></h2>
<iframe width="640" height="360" src="//www.youtube.com/embed/wE-yc_CGpfE?feature=player_detailpage" frameborder="0" allowfullscreen="1">&nbsp;</iframe></div>
<div class="section" id="chuan-bi">
<h2>Chuẩn bị<a class="headerlink" href="#chuan-bi" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Tên board mạch</strong></td>
<td><strong>Link</strong></td>
</tr>
<tr class="row-even"><td>Board IoT Wifi Uno</td>
<td><a class="reference external" href="https://iotmaker.vn/esp8266-iot-wifi-uno.html">https://iotmaker.vn/esp8266-iot-wifi-uno.html</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="dau-noi">
<h2>Đấu nối<a class="headerlink" href="#dau-noi" title="Permalink to this headline">¶</a></h2>
<p>Nút nhấn và LED board <code class="docutils literal"><span class="pre">IoT</span> <span class="pre">WiFi</span> <span class="pre">Uno</span></code> được khoanh tròn như trong hình</p>
<a class="reference external image-reference" href="../_static/basic/button.png"><img alt="../_images/button.png" src="../_images/button.png" /></a>
</div>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<div class="code cpp highlight-default"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ledPin</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>                 <span class="o">//</span> <span class="n">LED</span> <span class="n">connected</span> <span class="n">to</span> <span class="n">digital</span> <span class="n">pin</span> <span class="mi">16</span>
<span class="nb">int</span> <span class="n">btnPin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                  <span class="o">//</span> <span class="n">BUTTON</span> <span class="n">connected</span> <span class="n">to</span> <span class="n">digital</span> <span class="n">pin</span> <span class="mi">0</span>
<span class="nb">int</span> <span class="n">ledState</span> <span class="o">=</span> <span class="n">LOW</span><span class="p">;</span>

<span class="n">void</span> <span class="n">blink</span><span class="p">()</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">ledState</span> <span class="o">==</span> <span class="n">LOW</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ledState</span> <span class="o">=</span> <span class="n">HIGH</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">ledState</span> <span class="o">=</span> <span class="n">LOW</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">,</span> <span class="n">ledState</span><span class="p">);</span>
  <span class="n">Serial</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;Pressed, value=&quot;</span> <span class="o">+</span> <span class="n">String</span><span class="p">(</span><span class="n">ledState</span><span class="p">));</span>
<span class="p">}</span>
<span class="n">void</span> <span class="n">setup</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">ledPin</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>      <span class="o">//</span> <span class="n">sets</span> <span class="n">the</span> <span class="n">digital</span> <span class="n">pin</span> <span class="k">as</span> <span class="n">output</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">btnPin</span><span class="p">,</span> <span class="n">INPUT</span><span class="p">);</span>       <span class="o">//</span> <span class="n">sets</span> <span class="n">the</span> <span class="n">digital</span> <span class="n">pin</span> <span class="k">as</span> <span class="nb">input</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">btnPin</span><span class="p">,</span> <span class="n">INPUT_PULLUP</span><span class="p">);</span> <span class="o">//</span><span class="n">pull</span><span class="o">-</span><span class="n">up</span> <span class="n">button</span>
  <span class="n">attachInterrupt</span><span class="p">(</span><span class="n">btnPin</span><span class="p">,</span> <span class="n">blink</span><span class="p">,</span> <span class="n">FALLING</span><span class="p">);</span>
  <span class="n">Serial</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">void</span> <span class="n">loop</span><span class="p">()</span>
<span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="digital-io">
<h2>Digital IO<a class="headerlink" href="#digital-io" title="Permalink to this headline">¶</a></h2>
<p>Tên chân trong Arduino (Pin number) giống với thứ tự chân của ESP8266.
<code class="docutils literal"><span class="pre">pinMode</span></code>, <code class="docutils literal"><span class="pre">digitalRead</span></code>, và <code class="docutils literal"><span class="pre">digitalWrite</span></code> đều sử dụng Pin Number
như nhau, ví dụ như đọc GPIO2, gọi hàm <code class="docutils literal"><span class="pre">digitalRead(2)</span></code>.</p>
<p>Chân GPIO0..15 có thể là <code class="docutils literal"><span class="pre">INPUT</span></code>, <code class="docutils literal"><span class="pre">OUTPUT</span></code>, hay <code class="docutils literal"><span class="pre">INPUT_PULLUP</span></code>.
Chân GPIO16 có thể là <code class="docutils literal"><span class="pre">INPUT</span></code>, <code class="docutils literal"><span class="pre">OUTPUT</span></code> hay <code class="docutils literal"><span class="pre">INPUT_PULLDOWN_16</span></code>.
Khi khởi động, tất cả các chân sẽ được cấu hình là <code class="docutils literal"><span class="pre">INPUT</span></code>.</p>
<p>Mỗi chân có thể phục vụ cho một tính năng nào đó, ví dụ <code class="docutils literal"><span class="pre">Serial</span></code>,
<code class="docutils literal"><span class="pre">I2C</span></code>, <code class="docutils literal"><span class="pre">SPI</span></code>. Và tính năng đó sẽ được cấu hình đúng khi sử dụng thư
viện. Hình bên dưới thẻ hiện sơ đồ chân đối với module ESP-12 phổ biến.</p>
<p>GPIO6 và GPIO11 không được thể hiện bởi vì nó được sử dụng cho việc kết
nối với Flash. Việc sử dụng 2 chân này có thể gây lỗi chương trình.</p>
<div class="admonition note">
<p class="first admonition-title">Ghi chú</p>
<p class="last">Một số board và module khác (ví dụ ESP-12ED, NodeMCU 1.0) không có GPIO9 và GPIO11, họ sử dụng với chế độ <code class="docutils literal"><span class="pre">DIO</span></code> cho Flash, trong khi ESP12 chúng ta nói bên trên sử dụng chế độ <code class="docutils literal"><span class="pre">QIO</span></code></p>
</div>
<p>Ngắt GPIO hỗ trợ thông qua các hàm <code class="docutils literal"><span class="pre">attachInterrupt</span></code>, <code class="docutils literal"><span class="pre">detachInterrupt</span></code>
Ngắt GPIO có thể gán cho bất kỳ GPIO nào, ngoại trừ <code class="docutils literal"><span class="pre">GPIO16</span></code>. Đều hỗ trợ các ngắt tiêu chuẩn của Arduino như: <code class="docutils literal"><span class="pre">CHANGE</span></code>, <code class="docutils literal"><span class="pre">RISING</span></code>, <code class="docutils literal"><span class="pre">FALLING</span></code>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="analog.html" class="btn btn-neutral float-right" title="Đọc Analog" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="led.html" class="btn btn-neutral" title="LED" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, TuanPM.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>